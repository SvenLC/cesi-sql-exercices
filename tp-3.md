# TP Oracle SQL 3

## 3.1 Produit cartésien

### 1)

Sélection de : toutes les colonnes du produit catésien de COUNTRIES et de
REGIONS.

```sql
SELECT * FROM COUNTRIES, REGIONS;
```

## 3.2 Jointures simple (équijointures)

### 1)

Sélection de : nom du pays et du nom de sa régions pour tous les pays de COUNTRIES.

```sql
SELECT COUNTRY_NAME, REGION_NAME FROM COUNTRIES INNER JOIN REGIONS ON COUNTRIES.REGION_ID = REGIONS.REGION_ID;
```

### 2)

Sélection de : nom de la ville, nom du pays et du nom de sa régions pour toutes les villes de LOCATIONS.

```sql
SELECT CITY, COUNTRY_NAME, REGION_NAME FROM LOCATIONS
INNER JOIN COUNTRIES ON LOCATIONS.COUNTRY_ID = COUNTRIES.COUNTRY_ID
INNER JOIN REGIONS ON COUNTRIES.REGION_ID = REGIONS.REGION_ID;
```

### 3)

```sql
SELECT DEPARTMENT_NAME, REGION_NAME FROM DEPARTMENTS
INNER JOIN LOCATIONS ON DEPARTMENTS.LOCATION_ID = LOCATIONS.LOCATION_ID
INNER JOIN COUNTRIES ON LOCATIONS.COUNTRY_ID = COUNTRIES.COUNTRY_ID
INNER JOIN REGIONS ON COUNTRIES.REGION_ID = REGIONS.REGION_ID;
```

### 4)

```sql
SELECT DEPARTMENT_NAME, CITY FROM DEPARTMENTS
INNER JOIN LOCATIONS ON DEPARTMENTS.LOCATION_ID = LOCATIONS.LOCATION_ID;
```

## 3.3 Jointures externes

### 1)

Sélection de : nom département, nom de sa ville et nom de son manager, s’il existe, pour tous les départements de DEPARTMENTS

```sql
SELECT DEPARTMENT_NAME, CITY, LAST_NAME
FROM DEPARTMENTS
INNER JOIN LOCATIONS ON DEPARTMENTS.LOCATION_ID = LOCATIONS.LOCATION_ID
LEFT JOIN EMPLOYEES ON DEPARTMENTS.MANAGER_ID = EMPLOYEES.EMPLOYEE_ID;
```

### 2)

Sélection de : nom région, titre de job s’il existe, pour tous les régions de
REGIONS. Si une région n’a pas de job retourner la région , ‘pas de job’

```sql
SELECT DISTINCT REGION_NAME, NVL(JOB_TITLE, 'Pas de Job !')
FROM JOBS
INNER JOIN EMPLOYEES ON JOBS.JOB_ID = EMPLOYEES.JOB_ID
INNER JOIN DEPARTMENTS ON EMPLOYEES.DEPARTMENT_ID = DEPARTMENTS.DEPARTMENT_ID
INNER JOIN LOCATIONS ON DEPARTMENTS.LOCATION_ID = LOCATIONS.LOCATION_ID
INNER JOIN COUNTRIES ON LOCATIONS.COUNTRY_ID = COUNTRIES.COUNTRY_ID
FULL JOIN REGIONS ON COUNTRIES.REGION_ID = REGIONS.REGION_ID;
```

## 3.4 Auto-jointure

### 1)

) Sélection de : prénom, nom et nom du manager pour tous les employés de
EMPLOYEES ayant un salaire < 2500

```sql
SELECT e.FIRST_NAME, e.LAST_NAME, m.FIRST_NAME
FROM EMPLOYEES e
INNER JOIN EMPLOYEES m ON e.MANAGER_ID = m.EMPLOYEE_ID
WHERE e.SALARY < 2500;
```
